title: "Simulation study: CLT"
date: "11/12/2019"
author: "Wenying Gu"
output:
  html_document:
    code_folding: hide
    theme: united 
    highlight: tango
    toc: yes
    toc_depth: 6 
    toc_float: true
editor_options: 
  chunk_output_type: inline
---
### Email: [wenying.gu@vanderbilt.edu]()

# Background Information: Cenral Limit Theorem 
The central limit theorem is an important computational short-cut for generating and making inference from the sampling distribution of the mean. Youâ€™ll recall that the central limit theorem short-cut relies on a number of conditions, specifically:

* Independent observations
* Identically distributed observations
* Mean and variance exist
* Sample size large enough for convergence

# Load Packages 
Here is the packages magrittr and sn that we will use in this deliverable.
```{r}
require(magrittr)
#install.packages("sn")
require(sn)
```


```{r}
slant <- c(0,2,10,100)
loc <- 0
sc <- 1

r <- 5000
N <- c(5, 10, 20, 40)
```

# Parameters that do not change

```{r}
R<- 5000
location <-0
scale<-1
```

# Parameters that change

```{r}
N <- c(5,10,20,40)
slant <- c(0,2,10,100)
delta<-slant/(sqrt(1+slant^2))
```


# Quantites to calculate/generate

```{r}
generate_qqplot<-function(R, location, scale, N, slant, delta){
  pop_mean <- 
  location+scale*delta*(sqrt(2/pi))
  pop_sd <- 
  sqrt(scale^2*(1-((2*delta^2)/pi)))
  Z<- rnorm(R)
  sample_dist_clt <- 
  Z*(pop_sd/sqrt(N))+pop_mean

  random.skew<-
  array(rsn(R*N, xi=location,
  omega=scale, alpha=slant),
  dim=c(R,N))
  
  sample_dist_sim <-apply(random.skew,1,mean)
  
  qqplot(sample_dist_sim, 
       sample_dist_clt, asp = 1)
       abline(0,1)
}

```
`




